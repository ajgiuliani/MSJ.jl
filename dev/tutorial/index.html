<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · msJ.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-132913317-2', 'auto');
ga('send', 'pageview');
</script><link rel="canonical" href="https://ajgiuliani.github.io/msJ.jl/stable/tutorial/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="msJ.jl logo"/></a><h1>msJ.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../manual/">Manual</a></li><li class="current"><a class="toctext" href>Tutorial</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Loading-mass-spectrometry-data-1">Loading mass spectrometry data</a></li></ul></li><li><a class="toctext" href="../reference/">Reference</a></li><li><a class="toctext" href="../misc/">Miscellaneous</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Tutorial</a></li></ul><a class="edit-page" href="https://github.com/ajgiuliani/msJ.jl/blob/master/docs/src/tutorial.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Tutorial</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Tutorial-1" href="#Tutorial-1">Tutorial</a></h1><p>The msJ package intends to provide an access to the common open source mass spectrometry file format.</p><h1><a class="nav-anchor" id="Loading-mass-spectrometry-data-1" href="#Loading-mass-spectrometry-data-1">Loading mass spectrometry data</a></h1><p>For this example, the mzXML file from the test folder of the package will be used. First, the <a href="../reference/#msJ.info-Tuple{String}"><code>info</code></a> function may be used to see what&#39;s inside the file.</p><pre><code class="language-julia">using msJ
info(&quot;../../test/test.mzXML&quot;)</code></pre><pre><code class="language-none">4-element Array{String,1}:
 &quot;6 scans&quot;                
 &quot;MS1+&quot;                   
 &quot;MS2+ 1255.5  CID(CE=18)&quot;
 &quot;MS3+ 902.33  PQD(CE=35)&quot;</code></pre><p>From the output, we learn that the file contains MS scans in the positive ion mode, MS/MS scans also in positive mode, where the precursor m/z 1255.5 is activated under CID conditions with 18 collision energy and the m/Z 902.33 precursor is activated using the PQD method with the activation energy set to 35.</p><p>Then, the data can be loaded into a variable that we call <code>scans</code>.</p><pre><code class="language-julia">scans = load(&quot;../../test/test.mzXML&quot;)</code></pre><pre><code class="language-none">6-element Array{msJ.MSscan,1}:
 msJ.MSscan(1, 0.1384, 5.08195e6, [140.083, 140.167, 140.25, 140.333, 140.417, 140.5, 140.583, 140.667, 140.75, 140.833  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [236.317, 83.1408, 9.52081, 0.0, 0.0, 0.0, 0.0, 30.4295, 83.8695, 321.028  …  0.000809904, 6.63715e-5, 0.0, 0.0, 0.0, 1.94537e-7, 1.13457e-7, 1.90031e-8, 0.0, 0.0], 1, 628.333, 102558.0, 0.0, &quot;+&quot;, &quot;&quot;, 0.0)
 msJ.MSscan(2, 0.7307, 9727.2, [345.083, 345.167, 345.25, 345.333, 345.417, 345.5, 345.583, 345.667, 345.75, 345.833  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 2, 1255.42, 500.768, 1255.5, &quot;+&quot;, &quot;CID&quot;, 18.0)                                                         
 msJ.MSscan(3, 2.1379, 11.3032, [50.0833, 50.1667, 50.25, 50.3333, 50.4167, 50.5, 50.5833, 50.6667, 50.75, 50.8333  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 3, 560.0, 1.03864, 902.33, &quot;+&quot;, &quot;PQD&quot;, 35.0)                                                             
 msJ.MSscan(4, 3.7578, 4.8084e6, [140.083, 140.167, 140.25, 140.333, 140.417, 140.5, 140.583, 140.667, 140.75, 140.833  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [90.3754, 27.1395, 2.57984, 0.0, 0.0, 0.0, 0.0, 68.2838, 222.958, 396.038  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 1, 628.333, 92458.8, 0.0, &quot;+&quot;, &quot;&quot;, 0.0)                                      
 msJ.MSscan(5, 4.3442, 12203.5, [345.083, 345.167, 345.25, 345.333, 345.417, 345.5, 345.583, 345.667, 345.75, 345.833  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 2, 1255.5, 454.605, 1255.5, &quot;+&quot;, &quot;CID&quot;, 18.0)                                                         
 msJ.MSscan(6, 5.7689, 4.84455, [50.0833, 50.1667, 50.25, 50.3333, 50.4167, 50.5, 50.5833, 50.6667, 50.75, 50.8333  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 3, 611.167, 0.699387, 902.33, &quot;+&quot;, &quot;PQD&quot;, 35.0)                                                          </code></pre><p>As expected, the <code>scans</code> variable contains an array of 6 <code>MSscans</code>. The fields of the individual scans may be accessed by:</p><pre><code class="language-julia">println(&quot;scan num      : &quot;, scans[1].num)</code></pre><pre><code class="language-none">scan num      : 1</code></pre><pre><code class="language-julia">println(&quot;Polarity      : &quot;, scans[1].polarity)</code></pre><pre><code class="language-none">Polarity      : +</code></pre><pre><code class="language-julia">println(&quot;retention time: &quot;, scans[1].rt)</code></pre><pre><code class="language-none">retention time: 0.1384</code></pre><pre><code class="language-julia">println(&quot;MS level      : &quot;, scans[1].level)</code></pre><pre><code class="language-none">MS level      : 1</code></pre><pre><code class="language-julia">println(&quot;Base peak m/z : &quot;, scans[1].basePeakMz)</code></pre><pre><code class="language-none">Base peak m/z : 628.333</code></pre><pre><code class="language-julia">println(&quot;Base peak int.: &quot;, scans[1].basePeakIntensity)</code></pre><pre><code class="language-none">Base peak int.: 102558.0</code></pre><p>The mass spectrum is stored in two arrays:</p><pre><code class="language-julia">mz_2  =  scans[2].mz
int_2 =  scans[2].int ; nothing</code></pre><p>Getting chromatograms is straightforward using the <a href="../reference/#msJ.chromatogram-Tuple{String,Vararg{msJ.FilterType,N} where N}"><code>chromatogram</code></a> method:</p><pre><code class="language-julia">full_TIC   = chromatogram(scans)</code></pre><pre><code class="language-none">msJ.Chromatogram([0.1384, 0.7307, 2.1379, 3.7578, 4.3442, 5.7689], [5.08195e6, 9727.2, 11.3032, 4.8084e6, 12203.5, 4.84455], 5.08195e6)</code></pre><pre><code class="language-julia">MS1_TIC    = chromatogram(scans, msJ.Level(1))</code></pre><pre><code class="language-none">msJ.Chromatogram([0.1384, 3.7578], [5.08195e6, 4.8084e6], 5.08195e6)</code></pre><pre><code class="language-julia">CID_TIC    = chromatogram(scans, msJ.Activation_Method(&quot;CID&quot;))</code></pre><pre><code class="language-none">msJ.Chromatogram([0.7307, 4.3442], [9727.2, 12203.5], 12203.5)</code></pre><pre><code class="language-julia">mz902_TIC  = chromatogram(scans, msJ.Precursor(902.33))</code></pre><pre><code class="language-none">msJ.Chromatogram([2.1379, 5.7689], [11.3032, 4.84455], 11.3032)</code></pre><p>The individual extracted chromatogram may be plotted. First we need to import the <code>Julia</code> package for plotting. Then, we can make a figure with the chromatograms:</p><pre><code class="language-julia">using Plots ;
p1 = plot(full_TIC, label = &quot;full tic&quot;)
p2 = plot(MS1_TIC, label = &quot; MS1_TIC&quot;)
p3 = plot(CID_TIC, label = &quot;CID_TIC&quot;)
p4 = plot(mz902_TIC, label = &quot;mz902_TIC&quot;)

plot(p1, p2, p3, p4, layout = (4,1))</code></pre><pre><code class="language-none">/home/travis/.julia/packages/GR/ZI5OE/src/../deps/gr/bin/gksqt: error while loading shared libraries: libQt5Widgets.so.5: cannot open shared object file: No such file or directory
connect: Connection refused
GKS: can&#39;t connect to GKS socket application
Did you start &#39;gksqt&#39;?

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</code></pre><p><img src="../chromatograms.png" alt/></p><p>Average mass spectra may be obtained using the proper <a href="../reference/#msJ.msfilter-Tuple{String,Vararg{msJ.FilterType,N} where N}"><code>msfilter</code></a> functions:</p><pre><code class="language-julia">ms1 = msfilter(scans, msJ.Level(1))
ms2_CID = msfilter(scans, msJ.Activation_Method(&quot;CID&quot;))
ms2_PQD = msfilter(scans, msJ.Activation_Method(&quot;PQD&quot;))
ms2_1255 = msfilter(scans, msJ.Precursor(1255.5))</code></pre><pre><code class="language-none">msJ.MSscans([2, 5], [0.7307, 4.3442], 21930.7, [345.083, 345.167, 345.25, 345.333, 345.417, 345.5, 345.583, 345.667, 345.75, 345.833  …  1999.25, 1999.33, 1999.42, 1999.5, 1999.58, 1999.67, 1999.75, 1999.83, 1999.92, 2000.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [2, 2], 1255.5, 473.00372314453125, [1255.5, 1255.5], [&quot;+&quot;, &quot;+&quot;], [&quot;CID&quot;, &quot;CID&quot;], [18.0, 18.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])</code></pre><p>and then plotted similarly:</p><pre><code class="language-julia">p5 = plot(ms1, label = &quot;MS&quot;, color = :blue)
p6 = plot(ms2_CID, label = &quot;CID&quot;, color = :green)
p7 = plot(ms2_PQD, label = &quot;PQD&quot;, color = :purple)
p8 = plot(ms2_1255, label = &quot;mz 1255&quot;, color = :orange)
plot(p5, p6, p7, p8, layout = (4,1), size = (800,600))</code></pre><pre><code class="language-none">/home/travis/.julia/packages/GR/ZI5OE/src/../deps/gr/bin/gksqt: error while loading shared libraries: libQt5Widgets.so.5: cannot open shared object file: No such file or directory
connect: Connection refused
GKS: can&#39;t connect to GKS socket application
Did you start &#39;gksqt&#39;?

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</code></pre><p><img src="../ms.png" alt/></p><p>The average mass spectrum for CID (green) and for the m/z 1255.5 precursor ion (orange) are identical, which is not surprising.</p><footer><hr/><a class="previous" href="../manual/"><span class="direction">Previous</span><span class="title">Manual</span></a><a class="next" href="../reference/"><span class="direction">Next</span><span class="title">Reference</span></a></footer></article></body></html>
