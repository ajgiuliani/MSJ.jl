<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Processing · MSj.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-132913317-2', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link rel="canonical" href="https://ajgiuliani.github.io/MSj.jl/stable/man/processing/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MSj.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MSj.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutos/julia/">The Julia language</a></li><li><a class="tocitem" href="../../tutos/jupyter/">Jupyer notebooks</a></li><li><a class="tocitem" href="../../tutos/MSj/">MSj</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../public/">Public elements</a></li><li><a class="tocitem" href="../types/">Data types</a></li><li><a class="tocitem" href="../information/">File Information</a></li><li><a class="tocitem" href="../importing/">Importing data</a></li><li><a class="tocitem" href="../exporting/">Exporting data</a></li><li><a class="tocitem" href="../filtering/">Combining and filtering data</a></li><li class="is-active"><a class="tocitem" href>Processing</a><ul class="internal"><li><a class="tocitem" href="#Smooth-1"><span>Smooth</span></a></li><li><a class="tocitem" href="#Base-line-correction-1"><span>Base line correction</span></a></li><li><a class="tocitem" href="#Peak-picking-1"><span>Peak picking</span></a></li></ul></li><li><a class="tocitem" href="../calculations/">Properties calculations</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../reference/">References</a></li><li><a class="tocitem" href="../../misc/">Miscellaneous</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Processing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Processing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ajgiuliani/MSj.jl/blob/master/docs/src/man/processing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Processing-1"><a class="docs-heading-anchor" href="#Processing-1">Processing</a><a class="docs-heading-anchor-permalink" href="#Processing-1" title="Permalink"></a></h1><h2 id="Smooth-1"><a class="docs-heading-anchor" href="#Smooth-1">Smooth</a><a class="docs-heading-anchor-permalink" href="#Smooth-1" title="Permalink"></a></h2><p>The <a href="../../reference/#MSj.smooth-Tuple{MSj.MScontainer}"><code>smooth</code></a> function is public and applies on <code>MSscan</code>or <code>MSscans</code> objects, with an optional <code>method</code> argument set to <code>MSj.SG(5, 9, 0)</code>.  Smoothing is performed on the <code>int</code> field using the <a href="https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter">Savinsky and Golay</a>. The first argument is the order (5 by default), the second is the number of points (default 9)  and the last, is the derivative level (0). The function returns an <code>MScontainer</code> type identical to the input. </p><h2 id="Base-line-correction-1"><a class="docs-heading-anchor" href="#Base-line-correction-1">Base line correction</a><a class="docs-heading-anchor-permalink" href="#Base-line-correction-1" title="Permalink"></a></h2><p>Base line correction is performed using the <a href="man/@ref"><code>baseline_correction</code></a> function. This function as two methods and operates either on <a href="man/@ref"><code>MScontainer</code></a> or on Array of <a href="man/@ref"><code>MSscan</code></a> such as obtained after <a href="man/Importing data">importing data</a>.</p><pre><code class="language-julia">baseline_correction(scans)
baseline_correction(scans, method = MSj.IPSA(51, 100))</code></pre><p>The <code>method</code> argument allows choosing the algorithm. </p><h4 id="Top-Hat-1"><a class="docs-heading-anchor" href="#Top-Hat-1">Top Hat</a><a class="docs-heading-anchor-permalink" href="#Top-Hat-1" title="Permalink"></a></h4><p>This filter is based Top Hat transform used in image processing (<a href="https://en.wikipedia.org/wiki/Top-hat_transform">wikipedia</a>, <a href="https://pdfs.semanticscholar.org/c04c/afc9b2670edd1ea38f0f724cadbe2ec321e9.pdf">Sauve et al. (2004)</a>. The region onto which the operation is performed is set using the <code>region</code>field of the <a href="../../reference/#MSj.TopHat"><code>MSj.TopHat</code></a>. This filter removes every structure from the input which are smaller in size than the structuring element. Usually a region of 100 points is enough.This filter is fast and works quite well on large and complex backgrounds.</p><h4 id="Iterative-polynomial-smoothing-algorithm-(IPSA)-1"><a class="docs-heading-anchor" href="#Iterative-polynomial-smoothing-algorithm-(IPSA)-1">Iterative polynomial smoothing algorithm (IPSA)</a><a class="docs-heading-anchor-permalink" href="#Iterative-polynomial-smoothing-algorithm-(IPSA)-1" title="Permalink"></a></h4><p>The default algorithm is the IPSA for iterative polynomial smoothing algorithm (<a href="https://doi.org/10.1177/0003702816670915">Wang et al. (2017)</a>. This iterative algorithm use a zero ordre Savinsly and Golay smoothing to estimate a background. Then a new input, constructed by taking the minimum of either the original spectrum or the background, is smooth again. The process is repeated until the maximum iteration is reached or when the background does not change much. The termination criteria has been changed from the original paper.</p><h5 id="Locally-weighted-error-sum-of-squares-regression-(LOESS)-1"><a class="docs-heading-anchor" href="#Locally-weighted-error-sum-of-squares-regression-(LOESS)-1">Locally weighted error sum of squares regression (LOESS)</a><a class="docs-heading-anchor-permalink" href="#Locally-weighted-error-sum-of-squares-regression-(LOESS)-1" title="Permalink"></a></h5><p>The LOESS family of algorithm is based on non-parametric linear <a href="https://en.wikipedia.org/wiki/Local_regression">local regression</a> where the regression is weighted to reduced the influence of more distant data. We use here the iterative robust estimation procedure where the weights are updated with a bisquare function of the median of the residuals. This algorithm takes the number of iteration to be performed. Usually 3 iteration is enough. This algorithm is slow and is not recommended. The implementation will be improved in future versions.</p><h2 id="Peak-picking-1"><a class="docs-heading-anchor" href="#Peak-picking-1">Peak picking</a><a class="docs-heading-anchor-permalink" href="#Peak-picking-1" title="Permalink"></a></h2><p>Pick-picking is performed using the public <a href="../../reference/#MSj.centroid-Tuple{MSj.MScontainer}"><code>centroid</code></a> function. It operates on <code>MSscan</code>or <code>MSscans</code>type of data and return a similar type. It takes a method argument, set by default to the Signal to Noise Analysis method: <code>MSj.SNRA</code>.</p><pre><code class="language-julia">centroid(scan)</code></pre><h4 id="Signal-to-Noise-Ratio-Analysis-(SNRA)-1"><a class="docs-heading-anchor" href="#Signal-to-Noise-Ratio-Analysis-(SNRA)-1">Signal to Noise Ratio Analysis (SNRA)</a><a class="docs-heading-anchor-permalink" href="#Signal-to-Noise-Ratio-Analysis-(SNRA)-1" title="Permalink"></a></h4><p>Signal to noise ratio analysis is a very general approach, which relies on the definition of noise. Here, we use TopHat filter to define the noise. Then the signal to noise ratio is calculated. Peaks are found by searching for a local maximum for which the signal to noise ratio is above the threshold. By defaults the <code>MSj.SNRA</code> uses a threshold = 1.0 and a structuring element of 100 points.</p><pre><code class="language-julia">centroid(scan, method = MSj.SNRA(1., 100)</code></pre><h4 id="Threshold-base-peak-detection-algorithm-(TBPD)-1"><a class="docs-heading-anchor" href="#Threshold-base-peak-detection-algorithm-(TBPD)-1">Threshold base peak detection algorithm (TBPD)</a><a class="docs-heading-anchor-permalink" href="#Threshold-base-peak-detection-algorithm-(TBPD)-1" title="Permalink"></a></h4><p>The TBPD method identifies features based on their similarity (as described by the Pearson correlation coefficient) with a <a href="https://doi.org/10.1007/978-1-60761-987-1_22">template peak</a>. By default the <code>MSj.TBPD</code> method type uses a Gaussian function, with 1000 mass resolving power and a threshold level set to 0.2% as :</p><pre><code class="language-julia">centroid(scan, method = MSj.TBPD(:gauss, 1000, 0.2)</code></pre><p>Two other shape functions are available:</p><ul><li><code>:loretz</code> which uses a Cauchy-Lorentz function and</li><li><code>:voigt</code> which implements a pseudo-voigt profile (<a href="https://doi.org/10.1107%2Fs0021889800010219">Ida et al., J. Appl. Cryst. (2000)</a>, <a href="https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation">Wikipedia</a>)</li></ul><p>The <code>:lorentz</code> profile fits better Fourrier Transform mass spectra. The <code>:voigt</code> shape is the result of the convolution of gaussi and Cauchy-Lorentz shape.</p><pre><code class="language-julia">centroid(scan, method = MSj.TBPD(:lorentz, 1000., 0.1)
centroid(scan, method = MSj.TBPD(:voight,  1000., 0.1)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../filtering/">« Combining and filtering data</a><a class="docs-footer-nextpage" href="../calculations/">Properties calculations »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 14 December 2019 09:56">Saturday 14 December 2019</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
